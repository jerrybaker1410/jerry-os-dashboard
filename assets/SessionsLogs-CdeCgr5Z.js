import{j as e}from"./vendor-query-BDlgVFKC.js";import{r as o}from"./vendor-react-C3UgDDkQ.js";import{u as b}from"./vendor-virtual-BChkfkd2.js";import{G as N,m as v,n as y,A as f,j as S,b as w,f as k,o as C,p,q as A,r as L}from"./index-BLPMiw5x.js";import{P as z}from"./PageHeader-DXQHnwq5.js";import{S as E}from"./StatusBadge-x29XDuZr.js";import{C as I}from"./CopyButton-B9VrSSor.js";import{E as R}from"./EmptyState-BRa_Xz5S.js";import{X as T,b as u,d as $}from"./vendor-icons-DvjlSrBB.js";import"./vendor-dates-DKd7Sy4i.js";const V={info:"text-accent-blue",debug:"text-text-muted",warn:"text-accent-yellow",error:"text-accent-red"};function D({session:t,isSelected:s,onSelect:l}){const a=Object.values(f).find(r=>r.id===t.agent);return e.jsxs("button",{onClick:()=>l(t.id),className:`w-full text-left px-4 py-3 flex items-center gap-3 transition-colors ${s?"bg-accent-blue/10 border-l-2 border-l-accent-blue":"hover:bg-elevated/50 border-l-2 border-l-transparent"}`,children:[e.jsx("span",{className:"text-sm",children:a?.emoji||"ðŸ¤–"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-text-primary truncate",children:t.task}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("span",{className:"text-caption text-text-muted",children:t.agentName}),e.jsx("span",{className:"text-caption text-text-muted",children:"Â·"}),e.jsx("span",{className:"text-caption text-text-muted",children:L(t.startedAt)})]})]}),e.jsx(E,{status:t.status}),e.jsx($,{size:14,className:"text-text-muted"})]})}function G({session:t}){const s=Object.values(f).find(a=>a.id===t.agent),l=t.endedAt?S(t.startedAt,t.endedAt):"In progress";return e.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4 bg-surface border border-border-default rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-caption text-text-muted uppercase mb-1",children:"Agent"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:s?.emoji||"ðŸ¤–"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-primary",children:t.agentName}),e.jsx("p",{className:"text-caption text-text-muted",children:s?.role||""})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-caption text-text-muted uppercase mb-1",children:"Model"}),e.jsx(I,{text:t.model}),e.jsx("p",{className:"text-caption text-text-muted",children:l})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-caption text-text-muted uppercase mb-1",children:"Usage"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-primary font-data",children:w((t.tokensIn||0)+(t.tokensOut||0))}),e.jsx("p",{className:"text-caption text-text-muted",children:"tokens"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-primary font-data",children:k(t.cost)}),e.jsx("p",{className:"text-caption text-text-muted",children:"cost"})]})]})]}),t.tools&&t.tools.length>0&&e.jsxs("div",{className:"col-span-3 pt-2 border-t border-border-default",children:[e.jsx("p",{className:"text-caption text-text-muted uppercase mb-1.5",children:"Tools Used"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.tools.map(a=>e.jsx("span",{className:"text-caption px-2 py-0.5 rounded bg-elevated text-text-muted",children:a},a))})]})]})}function O({sessionId:t}){const{data:s,isLoading:l}=C(t),a=o.useRef(null);return o.useEffect(()=>{a.current?.scrollIntoView({behavior:"smooth"})},[s]),l?e.jsx("div",{className:"bg-[#0a0a0a] rounded-lg border border-border-default p-4 space-y-2",children:Array.from({length:6}).map((r,n)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{className:"h-3 w-16"}),e.jsx(p,{className:"h-3 w-10"}),e.jsx(p,{className:"h-3 flex-1"})]},n))}):!s||s.length===0?e.jsxs("div",{className:"bg-[#0a0a0a] rounded-lg border border-border-default p-6 text-center",children:[e.jsx(u,{size:20,className:"mx-auto text-text-muted mb-2"}),e.jsx("p",{className:"text-sm text-text-muted",children:"No logs available for this session"})]}):e.jsxs("div",{className:"bg-[#0a0a0a] rounded-lg border border-border-default overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-border-default bg-elevated/30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{size:12,className:"text-text-muted"}),e.jsx("span",{className:"text-caption text-text-muted font-medium uppercase",children:"Session Logs"})]}),e.jsxs("span",{className:"text-caption text-text-muted",children:[s.length," entries"]})]}),e.jsxs("div",{className:"max-h-[360px] overflow-y-auto font-mono text-xs leading-relaxed p-3 space-y-0.5",role:"log","aria-live":"polite",children:[s.map((r,n)=>e.jsxs("div",{className:"flex gap-2 py-0.5 hover:bg-elevated/20 rounded px-1 -mx-1",children:[e.jsx("span",{className:"text-text-muted shrink-0 w-20",children:A(r.ts)}),e.jsx("span",{className:`shrink-0 w-12 uppercase font-medium ${V[r.level]||"text-text-muted"}`,children:r.level}),e.jsx("span",{className:"text-text-secondary",children:r.message})]},n)),e.jsx("div",{ref:a})]})]})}function P({sessions:t,selectedId:s,onSelect:l,statusFilter:a}){const r=o.useRef(null),n=b({count:t.length,getScrollElement:()=>r.current,estimateSize:()=>64,overscan:5});return t.length===0?e.jsx("div",{className:"flex-1",children:e.jsx(R,{icon:u,title:"No sessions found",subtitle:a!=="all"?`No ${a} sessions`:"Sessions will appear here when agents run"})}):e.jsx("div",{ref:r,className:"flex-1 overflow-y-auto",children:e.jsx("div",{style:{height:`${n.getTotalSize()}px`,position:"relative"},children:n.getVirtualItems().map(c=>{const i=t[c.index];return e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${c.start}px)`},children:e.jsx(D,{session:i,isSelected:s===i.id,onSelect:l})},i.id||c.key)})})})}function K(){const{gatewayConnected:t}=o.useContext(N),{data:s=[],isLoading:l,error:a,refetch:r}=v({sseConnected:t}),[n,c]=o.useState(null),[i,j]=o.useState("all");if(l)return e.jsx(y,{});if(a)return e.jsxs("div",{className:"text-accent-red p-4",children:["Error loading sessions: ",a.message]});const x=Array.isArray(s)?s:[],h=i==="all"?x:x.filter(d=>d.status===i),m=x.find(d=>d.id===n),g=["all","active","completed","idle"];return e.jsxs("div",{className:"page-enter space-y-4",children:[e.jsx(z,{title:"Sessions & Logs",subtitle:`${x.length} sessions tracked`,onRefresh:r,actions:e.jsx("div",{className:"flex items-center gap-1 bg-surface border border-border-default rounded-md p-0.5",children:g.map(d=>e.jsx("button",{type:"button",onClick:()=>j(d),className:`px-2.5 py-1 rounded text-xs font-medium transition-colors ${i===d?"bg-accent-blue/10 text-accent-blue":"text-text-muted hover:text-text-secondary"}`,children:d==="all"?"All":d},d))})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",style:{minHeight:"500px"},children:[e.jsxs("div",{className:"bg-surface border border-border-default rounded-lg overflow-hidden flex flex-col",children:[e.jsx("div",{className:"px-4 py-3 border-b border-border-default",children:e.jsxs("p",{className:"text-xs text-text-muted",children:[h.length," sessions"]})}),e.jsx(P,{sessions:h,selectedId:n,onSelect:c,statusFilter:i})]}),e.jsx("div",{className:"lg:col-span-2 space-y-4",children:m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-text-primary truncate",children:m.task}),e.jsx("button",{type:"button",onClick:()=>c(null),className:"p-2 rounded-md text-text-muted hover:text-text-secondary hover:bg-elevated transition-colors","aria-label":"Close session details",children:e.jsx(T,{size:16})})]}),e.jsx(G,{session:m}),e.jsx(O,{sessionId:m.id})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(u,{size:28,className:"mx-auto text-text-muted mb-3"}),e.jsx("p",{className:"text-sm text-text-muted",children:"Select a session to view details and logs"})]})})})]})]})}export{K as default};
