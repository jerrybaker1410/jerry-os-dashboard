import{j as e}from"./vendor-query-BDlgVFKC.js";import{r as m}from"./vendor-react-C3UgDDkQ.js";import{u as ee,S as te,v as se,a as ae,C as ne,b as re,c as le,D as ce,d as ie,e as oe,f as de,P as xe}from"./vendor-dnd-Dw_1-BC6.js";import{d as me,q as ue,G as B,T,U as E,o as R,X as pe,F as G,H as P,S as he}from"./vendor-icons-DvjlSrBB.js";import{A as _,E as ge,F as fe,H as be,I as je,J as ve,S as Ne}from"./index-BLPMiw5x.js";import"./vendor-dates-DKd7Sy4i.js";const ye={planning:"#3b82f6","in-progress":"#eab308","on-track":"#22c55e",complete:"#8b5cf6",drafted:"#3b82f6","in-qa":"#eab308",approved:"#22c55e",scheduled:"#f97316",published:"#8b5cf6"},Ce=m.memo(function({id:s,title:o,items:r,children:x}){const[u,p]=m.useState(!1),{setNodeRef:b,isOver:w}=ee({id:s}),g=ye[s]||"#6b6b6b";return e.jsxs("div",{ref:b,className:`flex flex-col min-w-[260px] max-w-[320px] flex-1 rounded-lg border transition-colors ${w?"kanban-drop-target":"border-border-default"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2.5 border-b border-border-default bg-surface/50 rounded-t-lg",children:[e.jsx("button",{type:"button",onClick:()=>p(N=>!N),className:"text-text-muted hover:text-text-primary transition-colors",children:u?e.jsx(me,{size:14}):e.jsx(ue,{size:14})}),e.jsx("span",{className:"w-2.5 h-2.5 rounded-full shrink-0",style:{backgroundColor:g}}),e.jsx("span",{className:"text-sm font-medium text-text-primary",children:o}),e.jsx("span",{className:"text-xs font-data text-text-muted ml-auto bg-elevated px-1.5 py-0.5 rounded",children:r.length})]}),!u&&e.jsx(te,{items:r.map(N=>N.id),strategy:se,children:e.jsxs("div",{className:"flex-1 p-2 space-y-2 min-h-[100px] bg-[#0f0f0f]/30",children:[x,r.length===0&&e.jsx("div",{className:"flex items-center justify-center h-20 text-xs text-text-muted border border-dashed border-border-default rounded-md",children:"Drop items here"})]})})]})}),q={planning:"#3b82f6","in-progress":"#eab308","on-track":"#22c55e",complete:"#8b5cf6",drafted:"#3b82f6","in-qa":"#eab308",approved:"#22c55e",scheduled:"#f97316",published:"#8b5cf6"};function we(t){return Object.values(_).find(o=>o.id===t)||{name:t,emoji:"ðŸ¤–",color:"#6b6b6b"}}function ke({agentId:t}){const s=we(t),o=s.name.split(" ").map(r=>r[0]).join("").slice(0,2).toUpperCase();return e.jsxs("span",{className:"inline-flex items-center gap-1 text-caption px-1.5 py-0.5 rounded-full border border-border-default bg-elevated/50",title:`${s.name} â€” ${s.role||""}`,children:[e.jsx("span",{className:"w-3.5 h-3.5 rounded-full flex items-center justify-center text-[7px] font-bold text-white shrink-0",style:{backgroundColor:s.color},children:o}),e.jsx("span",{className:"truncate max-w-[52px] text-text-secondary",children:s.name.split(" ")[0]})]})}const F=m.memo(function({item:s,type:o="goal",onClick:r}){const{attributes:x,listeners:u,setNodeRef:p,transform:b,transition:w,isDragging:g}=ae({id:s.id}),N={transform:ne.Transform.toString(b),transition:w},D=()=>r?.(s),j=q[s.status]||q.planning;if(o==="goal")return e.jsx("div",{ref:p,style:N,className:`group bg-surface border border-border-default rounded-lg overflow-hidden cursor-grab active:cursor-grabbing hover:border-border-hover hover:shadow-card-hover transition-all ${g?"kanban-card-dragging":"shadow-card"}`,onClick:D,children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1 shrink-0 rounded-l",style:{backgroundColor:j}}),e.jsxs("div",{className:"flex-1 p-3 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx("button",{type:"button",className:"text-text-muted opacity-0 group-hover:opacity-100 transition-opacity mt-0.5 cursor-grab",...x,...u,children:e.jsx(B,{size:14})}),e.jsx("h4",{className:"flex-1 text-sm font-medium text-text-primary leading-snug truncate",children:s.title})]}),s.target&&e.jsxs("div",{className:"flex items-center gap-1.5 mb-2 text-xs text-text-secondary",children:[e.jsx(T,{size:11,className:"text-accent-blue shrink-0"}),e.jsx("span",{className:"truncate",children:s.target})]}),s.metric&&e.jsx("p",{className:"text-detail text-text-muted mb-2 line-clamp-2",children:s.metric}),s.agents&&s.agents.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[s.agents.slice(0,3).map(v=>e.jsx(ke,{agentId:v},v)),s.agents.length>3&&e.jsxs("span",{className:"text-caption text-text-muted",children:["+",s.agents.length-3]})]})]})]})});const z={blog:{label:"Blog",color:"text-accent-blue bg-accent-blue/10"},social:{label:"Social",color:"text-accent-purple bg-accent-purple/10"},newsletter:{label:"Newsletter",color:"text-accent-green bg-accent-green/10"},video:{label:"Video",color:"text-accent-red bg-accent-red/10"},short:{label:"Short",color:"text-accent-orange bg-accent-orange/10"}}[(s.type||"").toLowerCase()]||{label:s.type||"Content",color:"text-text-muted bg-elevated"};return e.jsx("div",{ref:p,style:N,className:`group bg-surface border border-border-default rounded-lg overflow-hidden cursor-grab active:cursor-grabbing hover:border-border-hover hover:shadow-card-hover transition-all ${g?"kanban-card-dragging":"shadow-card"}`,onClick:D,children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1 shrink-0 rounded-l",style:{backgroundColor:j}}),e.jsxs("div",{className:"flex-1 p-3 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx("button",{type:"button",className:"text-text-muted opacity-0 group-hover:opacity-100 transition-opacity mt-0.5 cursor-grab",...x,...u,children:e.jsx(B,{size:14})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-caption uppercase font-medium px-1.5 py-0.5 rounded ${z.color}`,children:z.label}),e.jsx("span",{className:"text-caption text-text-muted font-data",children:s.id})]}),e.jsx("h4",{className:"text-sm font-medium text-text-primary leading-snug truncate",children:s.title})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-detail text-text-muted",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{size:11}),e.jsx("span",{children:s.authorAgent||"unassigned"})]}),s.due&&s.due!=="â€”"&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{size:11}),e.jsx("span",{children:s.due})]})]})]})]})})});function Se(t){return Object.values(_).find(s=>s.id===t)||{name:t,emoji:"ðŸ¤–",role:""}}function De({item:t,type:s="goal",onClose:o}){return t?e.jsxs("div",{className:"fixed inset-y-0 right-0 w-96 max-w-full glass border-l border-border-default z-50 flex flex-col animate-slide-in-right shadow-overlay",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border-default",children:[e.jsx("h2",{className:"text-sm font-semibold text-text-primary truncate",children:s==="goal"?"Goal Details":"Content Details"}),e.jsx("button",{type:"button",onClick:o,className:"text-text-muted hover:text-text-primary transition-colors p-2 rounded-md hover:bg-elevated",children:e.jsx(pe,{size:16})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:s==="goal"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:t.title}),e.jsxs("span",{className:"text-caption uppercase font-medium px-2 py-0.5 rounded bg-accent-blue/10 text-accent-blue",children:["Goal #",t.goalNumber]})]}),t.target&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-text-muted",children:[e.jsx(T,{size:12}),e.jsx("span",{children:"Target"})]}),e.jsx("p",{className:"text-sm text-text-primary",children:t.target})]}),t.why&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-text-muted",children:[e.jsx(G,{size:12}),e.jsx("span",{children:"Why"})]}),e.jsx("p",{className:"text-sm text-text-secondary",children:t.why})]}),t.metric&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-text-muted",children:[e.jsx(P,{size:12}),e.jsx("span",{children:"Key Metric"})]}),e.jsx("p",{className:"text-sm text-text-primary",children:t.metric})]}),t.agents&&t.agents.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-text-muted",children:[e.jsx(E,{size:12}),e.jsx("span",{children:"Owner Agents"})]}),e.jsx("div",{className:"space-y-1.5",children:t.agents.map(r=>{const x=Se(r);return e.jsxs("div",{className:"flex items-center gap-2 px-2.5 py-1.5 bg-elevated rounded-md",children:[e.jsx("span",{className:"text-sm",children:x.emoji}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-xs text-text-primary block truncate",children:x.name}),x.role&&e.jsx("span",{className:"text-caption text-text-muted block truncate",children:x.role})]})]},r)})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-caption uppercase font-medium px-2 py-0.5 rounded bg-elevated text-text-secondary",children:t.type}),e.jsx("span",{className:"text-xs text-text-muted font-data",children:t.id})]}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:t.title})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(E,{size:14,className:"text-text-muted"}),e.jsx("span",{className:"text-text-secondary",children:"Author:"}),e.jsx("span",{className:"text-text-primary",children:t.authorAgent||"Unassigned"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(P,{size:14,className:"text-text-muted"}),e.jsx("span",{className:"text-text-secondary",children:"Status:"}),e.jsx("span",{className:"text-text-primary capitalize",children:t.status})]}),t.due&&t.due!=="â€”"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(R,{size:14,className:"text-text-muted"}),e.jsx("span",{className:"text-text-secondary",children:"Due:"}),e.jsx("span",{className:"text-text-primary",children:t.due})]})]})]})})]}):null}const A=[{id:"planning",title:"Planning"},{id:"in-progress",title:"In Progress"},{id:"on-track",title:"On Track"},{id:"complete",title:"Complete"}],M=[{id:"drafted",title:"Drafted"},{id:"in-qa",title:"In QA"},{id:"approved",title:"Approved"},{id:"scheduled",title:"Scheduled"},{id:"published",title:"Published"}];function ze(t){if(!t)return[];const s=[],o=/### (\d+)\.\s+(.+)\n\*\*Target:\*\*\s*(.+)\n\*\*Why:\*\*\s*(.+)\n\*\*Metric:\*\*\s*(.+)\n\*\*Owner agents:\*\*\s*(.+)/g;let r;for(;(r=o.exec(t))!==null;){const u=r[6].split(",").map(p=>p.trim()).filter(Boolean).map(p=>{const b=p.match(/\(([^)]+)\)/);return b?b[1]:p});s.push({id:`goal-${r[1]}`,goalNumber:parseInt(r[1],10),title:r[2].trim(),target:r[3].trim(),why:r[4].trim(),metric:r[5].trim(),agents:u})}return s}function Te(){const[t,s]=m.useState("goals"),[o,r]=m.useState(null),[x,u]=m.useState(null),p=m.useCallback(a=>u(a),[]),{data:b,isLoading:w}=ge(),{data:g,isLoading:N}=fe(),D=be(),{data:j=[],isLoading:U}=je(),z=ve(),v=m.useMemo(()=>ze(b?.content),[b]),k=m.useMemo(()=>{const a={};if(A.forEach(n=>{a[n.id]=[]}),v.length>0){const n=g?.columns||{};v.forEach(c=>{const i=n[c.id]||"planning";a[i]?a[i].push(c):a.planning.push(c)});const l=g?.order||{};Object.keys(a).forEach(c=>{const i=l[c];i&&a[c].sort((f,C)=>{const y=i.indexOf(f.id),h=i.indexOf(C.id);return(y===-1?999:y)-(h===-1?999:h)})})}return a},[v,g]),L=m.useMemo(()=>{const a={};return M.forEach(n=>{a[n.id]=[]}),j.forEach(n=>{const l=(n.status||"drafted").toLowerCase();a[l]?a[l].push(n):a.drafted.push(n)}),a},[j]),Q=re(le(xe,{activationConstraint:{distance:5}})),$=m.useCallback(a=>{for(const[n,l]of Object.entries(k))if(l.some(c=>c.id===a))return n;return null},[k]),H=m.useCallback(a=>{for(const[n,l]of Object.entries(L))if(l.some(c=>c.id===a))return n;return null},[L]),K=m.useMemo(()=>o?t==="goals"?v.find(a=>a.id===o):j.find(a=>a.id===o):null,[o,t,v,j]);function J(a){r(a.active.id)}function V(a){const{active:n,over:l}=a;if(r(null),!l)return;const c=$(n.id);let i=null;if(A.some(h=>h.id===l.id)?i=l.id:i=$(l.id),!c||!i)return;const f={...g?.columns||{}},C={...g?.order||{}};f[n.id]=i;const y=[...k[i]||[]];if(c===i){const h=y.findIndex(d=>d.id===n.id),I=y.findIndex(d=>d.id===l.id);if(h!==-1&&I!==-1){const d=de(y,h,I);C[i]=d.map(O=>O.id)}}else{const h=v.find(d=>d.id===n.id);if(h){const d=y.filter(S=>S.id!==n.id),O=d.findIndex(S=>S.id===l.id);O!==-1?d.splice(O+1,0,h):d.push(h),C[i]=d.map(S=>S.id)}const I=(k[c]||[]).filter(d=>d.id!==n.id);C[c]=I.map(d=>d.id)}D.mutate({columns:f,order:C})}function W(a){r(a.active.id)}function X(a){const{active:n,over:l}=a;if(r(null),!l)return;let c=null;if(M.some(f=>f.id===l.id)?c=l.id:c=H(l.id),!c)return;const i=j.map(f=>f.id===n.id?{...f,status:c}:f);z.mutate(i)}if(t==="goals"?w||N:U)return e.jsx("div",{className:"page-enter",children:e.jsx(Ne,{})});const Y=t==="goals"?A:M,Z=t==="goals"?k:L;return e.jsxs("div",{className:"page-enter space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(he,{size:20,className:"text-accent-blue"}),e.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Kanban Board"})]}),e.jsxs("div",{className:"flex items-center bg-surface border border-border-default rounded-lg p-0.5",children:[e.jsxs("button",{type:"button",onClick:()=>s("goals"),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${t==="goals"?"bg-accent-blue/10 text-accent-blue":"text-text-secondary hover:text-text-primary"}`,children:[e.jsx(T,{size:13}),"Goals"]}),e.jsxs("button",{type:"button",onClick:()=>s("content"),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${t==="content"?"bg-accent-blue/10 text-accent-blue":"text-text-secondary hover:text-text-primary"}`,children:[e.jsx(G,{size:13}),"Content Pipeline"]})]})]}),e.jsxs(ce,{sensors:Q,collisionDetection:ie,onDragStart:t==="goals"?J:W,onDragEnd:t==="goals"?V:X,children:[e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4",children:Y.map(a=>{const n=Z[a.id]||[];return e.jsx(Ce,{id:a.id,title:a.title,items:n,children:n.map(l=>e.jsx(F,{item:l,type:t==="goals"?"goal":"content",onClick:p},l.id))},a.id)})}),e.jsx(oe,{children:K?e.jsx("div",{className:"kanban-card-dragging",children:e.jsx(F,{item:K,type:t==="goals"?"goal":"content"})}):null})]}),t==="content"&&j.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(G,{size:40,className:"text-text-muted mb-3"}),e.jsx("h3",{className:"text-sm font-medium text-text-primary mb-1",children:"Content Pipeline Empty"}),e.jsx("p",{className:"text-xs text-text-muted max-w-sm",children:"No content items in the queue yet. Content is added by Jerry Baker and the content-orchestrator agent as the pipeline runs."})]}),x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:()=>u(null)}),e.jsx(De,{item:x,type:t==="goals"?"goal":"content",onClose:()=>u(null)})]})]})}export{Te as default};
